import{_ as B}from"./Knob.vue_vue_type_style_index_0_scoped_b8894ed7_lang-BilKL6nt.js";import{h as g,o as m,c as v,t as V,n as E,m as $,g as S,k as w,F as I,r as R,l as q,v as H,a as y,f as J,p as U,j as T,q as D,b as F,w as N,i as K,s as W,x as j,y as P,z as L,A as z,B as Q,C as X,e as Y,d as Z,u as ee}from"./index-DmE6Qz1C.js";const te=["for"],le={__name:"TitleLabel",props:{schema:{type:Object,required:!0}},setup(_){var l;const n=_,e=g(((l=n.schema.check)==null?void 0:l.required)??!1);return(s,d)=>["radio","checkbox","switch"].includes(n.schema.type)?(m(),v("span",{key:0,class:E({requiredIcon:e.value})},V(n.schema.title),3)):(m(),v("label",{key:1,for:n.schema.key,class:E({requiredIcon:e.value})},V(n.schema.title),11,te))}},ae=B(le,[["__scopeId","data-v-3471dcc5"]]),ne={class:"fs-check"},se=["type","id","name","value","disabled"],oe=["for"],ue={__name:"CheckComponent",props:$({schema:{type:Object,required:!0}},{modelValue:{},modelModifiers:{}}),emits:$(["checkRules"],["update:modelValue"]),setup(_,{emit:n}){const e=_,l=S(_,"modelValue"),s=n,d=w(()=>e.schema.options.map(f=>{var h,b,k;if(!Array.isArray(l.value))return!1;const c=(k=(b=(h=e.schema.check)==null?void 0:h.rules)==null?void 0:b.find(({rule:C})=>"max"in C||"exact"in C))==null?void 0:k.rule;return c?(l.value.length>=c.exact||l.value.length>=c.max)&&!l.value.includes(f.value):!1}));return(f,c)=>(m(),v("span",ne,[(m(!0),v(I,null,R(e.schema.options,(h,b)=>(m(),v("span",{key:`${e.schema.key}_${b}`,class:"fs-checkItem"},[q(y("input",{type:e.schema.type,id:`${e.schema.key}_${b}`,name:e.schema.name,value:h.value,"onUpdate:modelValue":c[0]||(c[0]=k=>l.value=k),disabled:d.value[b],class:"fs-component__input fs-component__inputFocusTarget fs-checkItem__input",onBlur:c[1]||(c[1]=k=>s("checkRules",{type:k.type,target:{value:l.value}})),onChange:c[2]||(c[2]=k=>s("checkRules",{type:k.type,target:{value:l.value}}))},null,40,se),[[H,l.value]]),y("label",{for:`${e.schema.key}_${b}`},V(h.label),9,oe)]))),128))]))}},A=B(ue,[["__scopeId","data-v-e9689ae2"]]),ce={__name:"CollapseFunc",props:{open:{type:Boolean,required:!0},maxHeight:{type:String},minHeight:{type:String}},setup(_){J(d=>({f7884316:e.value,"9b72163a":l.value}));const n=_,e=w(()=>n.maxHeight??""),l=w(()=>n.minHeight??""),s=g("");return U(()=>{if(!n.open){s.value="";return}s.value="collapse--open",setTimeout(()=>s.value="collapse--open collapse--opened",300)}),(d,f)=>(m(),v("div",{class:E(["collapse__container",s.value])},[T(d.$slots,"default",{},void 0,!0)],2))}},G=B(ce,[["__scopeId","data-v-365f4d73"]]),re={class:"fs-select__inputBox"},ie=["placeholder","id"],pe={key:1,class:"fs-select__arrowIcon"},de=["onClick"],me={__name:"SelectComponent",props:$({schema:{type:Object,required:!0}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(_){const n=_,e=S(_,"modelValue"),l=g(!1),s=g(null),d=g(""),f=g(""),c=w(()=>d.value),h=w(()=>n.schema.options.filter(({label:a})=>a.includes(d.value))),b=()=>{const a=n.schema.options.find(({value:o})=>o===e.value);f.value=(a==null?void 0:a.label)??n.schema.placeholder,setTimeout(()=>d.value=(a==null?void 0:a.label)??"",300)},k=()=>{d.value="",l.value=!0},C=a=>{(a==null?void 0:a.relatedTarget)!==s.value&&(l.value=!1,(a==null?void 0:a.relatedTarget)!==s.value&&b())},O=a=>{e.value=a.value,C(null)},i=()=>e.value=void 0;return U(()=>b()),(a,o)=>(m(),v("span",null,[y("span",re,[q(y("input",{type:"text",placeholder:f.value,id:n.schema.key,class:"fs-component__input fs-component__inputFocusTarget fs-select__input","onUpdate:modelValue":o[0]||(o[0]=r=>d.value=r),onFocus:o[1]||(o[1]=()=>k()),onBlur:o[2]||(o[2]=r=>C(r))},null,40,ie),[[D,d.value]]),c.value?(m(),v("span",{key:0,class:"fs-select__eraseIcon",onClick:o[3]||(o[3]=()=>i())})):(m(),v("span",pe))]),F(G,{open:l.value},{default:N(()=>[y("ul",{class:"fs-select__options",ref_key:"collapseEL",ref:s,tabindex:"-1"},[(m(!0),v(I,null,R(h.value,r=>(m(),v("li",{key:r.value,class:"fs-select__option",onClick:()=>O(r)},V(r.label),9,de))),128))],512)]),_:1},8,["open"])]))}},fe=B(me,[["__scopeId","data-v-646a7e8d"]]),ve=["onClick"],_e=["id","placeholder"],he=["onClick"],be={__name:"MultiSelectComponent",props:$({schema:{type:Object,required:!0}},{modelValue:{},modelModifiers:{}}),emits:$(["checkRules"],["update:modelValue"]),setup(_,{emit:n}){var x;const e=_,l=S(_,"modelValue"),s=n,d=g(!1),f=g(null),c=g(""),h=g(null),b=g(null),k=w(()=>e.schema.options.filter(({value:u,label:t})=>t.includes(c.value)&&!l.value.includes(u))),C=()=>d.value=!0,O=u=>{u&&u.relatedTarget===f.value||(d.value=!1)},i=u=>{l.value=[...l.value,u.value],h.value.focus()},a=u=>l.value=l.value.filter(t=>t!==u),o=u=>{u.target===b.value&&h.value.focus()},r=g(((x=e.schema.check)==null?void 0:x.rules)!==void 0);return K(l,()=>{r.value&&s("checkRules",{type:"change",target:{value:l.value}})}),(u,t)=>(m(),v("span",null,[y("span",{class:"fs-component__inputFocusTarget fs-multi",ref_key:"inputBoxEl",ref:b,onClick:t[3]||(t[3]=p=>o(p))},[(m(!0),v(I,null,R(l.value,p=>(m(),v("span",{key:p,class:"fs-multi__selected",tabindex:"-1",onClick:()=>a(p)},V(e.schema.options.find(({value:M})=>M==p).label),9,ve))),128)),q(y("input",{type:"text",id:e.schema.key,placeholder:e.schema.placeholder,class:"fs-component__input fs-component__input-multi fs-multi__input",ref_key:"inputEl",ref:h,"onUpdate:modelValue":t[0]||(t[0]=p=>c.value=p),onFocus:t[1]||(t[1]=()=>C()),onBlur:t[2]||(t[2]=p=>O(p))},null,40,_e),[[D,c.value]])],512),F(G,{open:d.value},{default:N(()=>[y("ul",{class:"fs-select__options",ref_key:"collapseEL",ref:f,tabindex:"-1"},[(m(!0),v(I,null,R(k.value,p=>(m(),v("li",{key:p.value,class:"fs-select__option",onClick:()=>i(p)},V(p.label),9,he))),128))],512)]),_:1},8,["open"])]))}},ye=B(be,[["__scopeId","data-v-521a576d"]]),ke={class:"fs-switch"},ge=["value","name","id"],xe=["value","name","id"],Ce=["for"],$e={__name:"SwitchComponent",props:$({schema:{type:Object,required:!0}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(_){const n=_,e=S(_,"modelValue");return W(()=>e.value=e.value??n.schema.options[1]),(l,s)=>(m(),v("span",ke,[q(y("input",{type:"radio",value:n.schema.options[0],name:n.schema.name,id:`${n.schema.key}_a`,"onUpdate:modelValue":s[0]||(s[0]=d=>e.value=d),class:"fs-component__input fs-switch__input fs-switch__firstOption"},null,8,ge),[[j,e.value]]),q(y("input",{type:"radio",value:n.schema.options[1],name:n.schema.name,id:`${n.schema.key}_b`,"onUpdate:modelValue":s[1]||(s[1]=d=>e.value=d),class:"fs-component__input fs-switch__input"},null,8,xe),[[j,e.value]]),y("label",{for:`${n.schema.key}_${e.value===n.schema.options[0]?"b":"a"}`,class:"fs-component__inputFocusTarget fs-switch__switch"},null,8,Ce)]))}},we=B($e,[["__scopeId","data-v-35dd3168"]]),Ve=["type","id","placeholder","max","min","step"],Ie={__name:"InputComponent",props:$({schema:{type:Object,required:!0}},{modelValue:{},modelModifiers:{}}),emits:$(["checkRules"],["update:modelValue"]),setup(_,{emit:n}){const e=_,l=S(_,"modelValue"),s=n;return(d,f)=>(m(),v("span",null,[q(y("input",{type:e.schema.type,id:e.schema.key,placeholder:e.schema.placeholder,"onUpdate:modelValue":f[0]||(f[0]=c=>l.value=c),max:e.schema.max,min:e.schema.min,step:e.schema.step,class:"fs-component__input fs-component__inputFocusTarget",onInput:f[1]||(f[1]=c=>s("checkRules",c)),onBlur:f[2]||(f[2]=c=>s("checkRules",c))},null,40,Ve),[[H,l.value]])]))}},qe=["data-content"],Be={class:"fs-outputBtn"},Oe={class:"fs-outputBtn__sampleBtn"},Me={__name:"FormSchema",props:{schema:{type:Array,required:!0},layout:{type:Object},mainColor:{type:String},outlineColor:{type:String}},emits:["output","handleRequiredEmpty","handleInputWrong"],setup(_,{emit:n}){const e={radio:A,checkbox:A,select:fe,"multi-select":ye,switch:we,default:Ie},l=["checkbox","multi-select"],s=_,d=n,f=P([]),c=g({});W(()=>{s.schema.map(({type:i,name:a,default:o,...r})=>{const x=a.split("").reduce((p,M)=>p+=M.charCodeAt(0).toString(36),""),u=e[i]??e.default,t=l.includes(i);f.value=[...f.value,{type:i,name:a,default:o,...r,key:x,component:u}],c.value={...c.value,[a]:o??(t?[]:void 0)}})});const h=g({}),b=(i,a)=>{const{type:o,target:r}=i,{name:x,check:u}=a;if(u!==void 0)for(const t of(u==null?void 0:u.rules)??[]){if(t.on!==o)continue;const p=typeof t.warning=="function"?t.warning:()=>h.value[x]=t.warning;if(typeof t.rule=="string"&&t.rule!=r.value){p();break}if(t.rule instanceof RegExp&&!t.rule.test(r.value)){p();break}if("exact"in t.rule&&r.value.length!==t.rule.exact||"max"in t.rule&&r.value.length>t.rule.max||"min"in t.rule&&r.value.length<t.rule.min){p();break}if("same"in t.rule&&r.value!==c.value[t.rule.same]){p();break}h.value[x]=void 0}},k=()=>{let i=c.value;for(const{name:a,type:o,default_output:r,check:x}of f.value){const{[a]:u,...t}=i,p=u===void 0||l.includes(o)&&u.length===0;if(x!=null&&x.required&&p){d("handleRequiredEmpty");return}if(Object.values(h.value).some(M=>M!==void 0)){d("handleInputWrong");return}p&&r!==void 0&&(i={...t,[a]:r})}d("output",i)},C=w(()=>{var a;let i={};return s.mainColor&&(i={...i,"--fs-main-color":s.mainColor,"--fs-main-color-a":`${s.mainColor}66`}),s.outlineColor&&(i={...i,"--fs-outline-color":s.outlineColor}),(a=s.layout)!=null&&a.gap&&(i={...i,"--fs-gap":s.layout.gap}),i}),O=w(()=>{var a,o;const i=(o=(a=s.layout)==null?void 0:a.direction)==null?void 0:o.toLowerCase();return f.value.reduce((r,{name:x,layout:u})=>{var p;let t={};return(((p=u==null?void 0:u.direction)==null?void 0:p.toLowerCase())??i??"x")==="y"&&(t={...t,gridTemplateColumns:"1fr"}),u!=null&&u.gridArea&&(t={...t,gridArea:u.gridArea}),u!=null&&u.titleGap&&(t={...t,gap:u.titleGap}),r={...r,[x]:t},r},{})});return(i,a)=>(m(),v("div",{class:"fs-main",style:L(C.value)},[(m(!0),v(I,null,R(f.value,o=>(m(),v(I,null,[o.show??!0?(m(),v("div",{key:o.key,class:"fs-components",style:L(O.value[o.name]),"data-content":h.value[o.name]},[F(ae,{schema:o,class:"fs-components__title"},null,8,["schema"]),(m(),z(Q(o.component),{schema:o,modelValue:c.value[o.name],"onUpdate:modelValue":r=>c.value[o.name]=r,onCheckRules:r=>b(r,o)},null,40,["schema","modelValue","onUpdate:modelValue","onCheckRules"]))],12,qe)):X("",!0)],64))),256)),y("div",Be,[y("span",{onClick:k},[T(i.$slots,"outputButton",{},()=>[y("button",Oe,[T(i.$slots,"default",{},()=>[Y("確定")])])])]),T(i.$slots,"other")])],4))}},Te=Z({__name:"FormSchema",setup(_){const n=[{type:"select",name:"field1",title:"autocomplete下拉",placeholder:"請輸入並選擇",options:[{label:"選項一",value:"a"},{label:"選項二",value:"b"},{label:"選項三",value:"c"},{label:"選項四",value:"d"}]},{type:"switch",name:"field2",title:"切換開關",options:[!0,!1]},{type:"checkbox",name:"field3",title:"勾選",default:["a","b"],options:[{label:"選項一",value:"a"},{label:"選項二",value:"b"},{label:"選項三",value:"c"},{label:"選項四",value:"d"}],check:{rules:[{on:"change",rule:{exact:2},warning:"數量不符"}]}},{type:"radio",name:"field4",title:"單選",options:[{label:"選項一",value:"a"},{label:"選項二",value:"b"},{label:"選項三",value:"c"}],check:{required:!0}},{type:"multi-select",name:"field5",title:"多選下拉",placeholder:"請輸入搜尋字",default:["a","a1","b"],options:[{label:"選項一",value:"a"},{label:"選項一之一",value:"a1"},{label:"選項二",value:"b"},{label:"選項三",value:"c"},{label:"選項三之一",value:"c1"},{label:"選項三之二",value:"c2"},{label:"選項四",value:"d"},{label:"選項五",value:"e"},{label:"選項六",value:"f"},{label:"選項七",value:"g"}],check:{required:!0,rules:[{on:"change",rule:{min:3},warning:"太少了"},{on:"change",rule:{max:5},warning:"多了!! 多了!!"}]}},{type:"number",name:"field6",title:"數字",placeholder:"二的倍數",default_output:0,min:2,max:98,step:2},{type:"password",name:"pwd",title:"密碼",placeholder:"請輸入密碼",check:{rules:[{on:"blur",rule:/\w{6,20}/,warning:"密碼格式不符"}]}},{type:"password",name:"pwd_2",title:"密碼確認",placeholder:"請再次輸入密碼",check:{rules:[{on:"blur",rule:{same:"pwd"},warning:"密碼不相符"}]}}];return(e,l)=>(m(),z(ee(Me),{schema:n,"main-color":"#c1430d",onOutput:l[0]||(l[0]=s=>console.log(s)),onHandleRequiredEmpty:l[1]||(l[1]=()=>console.log("有必填未填")),onHandleInputWrong:l[2]||(l[2]=()=>console.log("有不符合規則"))}))}});export{Te as default};
